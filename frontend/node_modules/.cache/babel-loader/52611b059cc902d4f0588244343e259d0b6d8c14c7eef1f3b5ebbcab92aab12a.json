{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'BookSpot',\n  data() {\n    return {\n      lot_id: null,\n      spot_id: null,\n      user_id: null,\n      vehicle_number: '',\n      isLoading: true,\n      isSubmitting: false\n    };\n  },\n  async created() {\n    try {\n      // Fetch user info from localStorage\n      const tokenData = JSON.parse(localStorage.getItem('user') || '{}');\n      this.user_id = tokenData.user_id;\n      this.lot_id = this.$route.query.lot_id;\n      const token = localStorage.getItem('auth_token');\n      const response = await fetch(`http://localhost:5000/api/available-spot?lot_id=${this.lot_id}`, {\n        headers: {\n          'Authorization': `${token}`\n        }\n      });\n      const data = await response.json();\n      if (response.ok && data.spot_number) {\n        this.spot_id = data.spot_number;\n      } else {\n        this.showAlert('No available spot found in the selected lot.', 'warning');\n        this.$router.push('/user-dashboard');\n      }\n    } catch (err) {\n      console.error('Error fetching spot:', err);\n      this.showAlert('Error contacting server. Please login again or try later.', 'error');\n      this.$router.push('/user-dashboard');\n    } finally {\n      this.isLoading = false;\n    }\n  },\n  methods: {\n    async submitBooking() {\n      this.isSubmitting = true;\n      try {\n        const token = localStorage.getItem('auth_token');\n        const response = await fetch('http://localhost:5000/api/book-spot', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `${token}`\n          },\n          body: JSON.stringify({\n            lot_id: this.lot_id,\n            spot_id: this.spot_id,\n            user_id: this.user_id,\n            vehicle_number: this.vehicle_number\n          })\n        });\n        const result = await response.json();\n        if (response.ok) {\n          this.showAlert('Spot booked successfully!', 'success');\n          setTimeout(() => {\n            this.$router.push('/user-dashboard');\n          }, 1500);\n        } else {\n          this.showAlert('Booking failed: ' + (result.message || 'Unknown error'), 'error');\n        }\n      } catch (error) {\n        console.error('Booking error:', error);\n        this.showAlert('Server error. Please try again later.', 'error');\n      } finally {\n        this.isSubmitting = false;\n      }\n    },\n    cancel() {\n      this.$router.push('/user-dashboard');\n    },\n    showAlert(message, type) {\n      // Create and show custom alert\n      const alertDiv = document.createElement('div');\n      alertDiv.className = `custom-alert alert-${type}`;\n      alertDiv.innerHTML = `\n        <div class=\"alert-content\">\n          <span class=\"alert-icon\">\n            ${type === 'success' ? '✅' : type === 'warning' ? '⚠️' : '❌'}\n          </span>\n          <span class=\"alert-message\">${message}</span>\n        </div>\n      `;\n      document.body.appendChild(alertDiv);\n\n      // Animate in\n      setTimeout(() => alertDiv.classList.add('show'), 100);\n\n      // Remove after 3 seconds\n      setTimeout(() => {\n        alertDiv.classList.remove('show');\n        setTimeout(() => document.body.removeChild(alertDiv), 300);\n      }, 3000);\n    }\n  }\n};","map":{"version":3,"names":["name","data","lot_id","spot_id","user_id","vehicle_number","isLoading","isSubmitting","created","tokenData","JSON","parse","localStorage","getItem","$route","query","token","response","fetch","headers","json","ok","spot_number","showAlert","$router","push","err","console","error","methods","submitBooking","method","body","stringify","result","setTimeout","message","cancel","type","alertDiv","document","createElement","className","innerHTML","appendChild","classList","add","remove","removeChild"],"sources":["C:\\Users\\DELL\\OneDrive\\Desktop\\vehicle_parking_app_23f3004276\\frontend\\src\\views\\BookSpot.vue"],"sourcesContent":["<template>\r\n  <div class=\"booking-container\">\r\n    <!-- Background decoration -->\r\n    <div class=\"bg-decoration\"></div>\r\n    \r\n    <!-- Main booking card -->\r\n    <div class=\"booking-card\">\r\n      <!-- Header -->\r\n      <div class=\"booking-header\">\r\n        <div class=\"header-icon\">\r\n          <svg width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\"/>\r\n            <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\"/>\r\n            <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\"/>\r\n          </svg>\r\n        </div>\r\n        <div>\r\n          <h1 class=\"booking-title\">Reserve Your Spot</h1>\r\n          <p class=\"booking-subtitle\">Secure your parking space in seconds</p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Booking form -->\r\n      <form @submit.prevent=\"submitBooking\" class=\"booking-form\">\r\n        <!-- Lot Information -->\r\n        <div class=\"info-section\">\r\n          <h3 class=\"section-title\">Parking Details</h3>\r\n          <div class=\"info-grid\">\r\n            <div class=\"info-item\">\r\n              <label class=\"info-label\">Lot ID</label>\r\n              <div class=\"info-value\">{{ lot_id || 'Loading...' }}</div>\r\n            </div>\r\n            <div class=\"info-item\">\r\n              <label class=\"info-label\">Assigned Spot</label>\r\n              <div class=\"info-value spot-highlight\">{{ spot_id || 'Finding spot...' }}</div>\r\n            </div>\r\n            <div class=\"info-item\">\r\n              <label class=\"info-label\">User ID</label>\r\n              <div class=\"info-value\">{{ user_id || 'Loading...' }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Vehicle Input -->\r\n        <div class=\"input-section\">\r\n          <label for=\"vehicleNumber\" class=\"input-label\">\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <path d=\"M7 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0\"/>\r\n              <path d=\"M17 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0\"/>\r\n              <path d=\"M5 17h-2v-6l2-5h9l4 5h1a2 2 0 0 1 2 2v4h-2\"/>\r\n              <path d=\"M9 17v-6h6v6\"/>\r\n              <path d=\"M9 5v6\"/>\r\n              <path d=\"M15 5v6\"/>\r\n            </svg>\r\n            Vehicle License Plate\r\n          </label>\r\n          <input \r\n            v-model=\"vehicle_number\" \r\n            type=\"text\" \r\n            class=\"vehicle-input\" \r\n            id=\"vehicleNumber\" \r\n            placeholder=\"Enter your license plate number\"\r\n            required\r\n          >\r\n        </div>\r\n\r\n        <!-- Action buttons -->\r\n        <div class=\"button-section\">\r\n          <button type=\"submit\" class=\"reserve-btn\" :disabled=\"isSubmitting\">\r\n            <svg v-if=\"!isSubmitting\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <polyline points=\"20,6 9,17 4,12\"/>\r\n            </svg>\r\n            <div v-else class=\"loading-spinner\"></div>\r\n            {{ isSubmitting ? 'Reserving...' : 'Reserve Spot' }}\r\n          </button>\r\n          <button type=\"button\" class=\"cancel-btn\" @click=\"cancel\" :disabled=\"isSubmitting\">\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/>\r\n              <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/>\r\n            </svg>\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </form>\r\n\r\n      <!-- Loading overlay -->\r\n      <div v-if=\"isLoading\" class=\"loading-overlay\">\r\n        <div class=\"loading-content\">\r\n          <div class=\"loading-spinner large\"></div>\r\n          <p>Finding available spot...</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'BookSpot',\r\n  data() {\r\n    return {\r\n      lot_id: null,\r\n      spot_id: null,\r\n      user_id: null,\r\n      vehicle_number: '',\r\n      isLoading: true,\r\n      isSubmitting: false,\r\n    };\r\n  },\r\n  async created() {\r\n    try {\r\n      // Fetch user info from localStorage\r\n      const tokenData = JSON.parse(localStorage.getItem('user') || '{}');\r\n      this.user_id = tokenData.user_id;\r\n      \r\n      this.lot_id = this.$route.query.lot_id;\r\n      \r\n      const token = localStorage.getItem('auth_token');\r\n      const response = await fetch(`http://localhost:5000/api/available-spot?lot_id=${this.lot_id}`, {\r\n        headers: {\r\n          'Authorization': `${token}`\r\n        }\r\n      });\r\n      \r\n      const data = await response.json();\r\n      \r\n      if (response.ok && data.spot_number) {\r\n        this.spot_id = data.spot_number;\r\n      } else {\r\n        this.showAlert('No available spot found in the selected lot.', 'warning');\r\n        this.$router.push('/user-dashboard');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching spot:', err);\r\n      this.showAlert('Error contacting server. Please login again or try later.', 'error');\r\n      this.$router.push('/user-dashboard');\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  },\r\n  methods: {\r\n    async submitBooking() {\r\n      this.isSubmitting = true;\r\n      \r\n      try {\r\n        const token = localStorage.getItem('auth_token');\r\n        const response = await fetch('http://localhost:5000/api/book-spot', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `${token}`\r\n          },\r\n          body: JSON.stringify({\r\n            lot_id: this.lot_id,\r\n            spot_id: this.spot_id,\r\n            user_id: this.user_id,\r\n            vehicle_number: this.vehicle_number\r\n          })\r\n        });\r\n        \r\n        const result = await response.json();\r\n        \r\n        if (response.ok) {\r\n          this.showAlert('Spot booked successfully!', 'success');\r\n          setTimeout(() => {\r\n            this.$router.push('/user-dashboard');\r\n          }, 1500);\r\n        } else {\r\n          this.showAlert('Booking failed: ' + (result.message || 'Unknown error'), 'error');\r\n        }\r\n      } catch (error) {\r\n        console.error('Booking error:', error);\r\n        this.showAlert('Server error. Please try again later.', 'error');\r\n      } finally {\r\n        this.isSubmitting = false;\r\n      }\r\n    },\r\n    \r\n    cancel() {\r\n      this.$router.push('/user-dashboard');\r\n    },\r\n    \r\n    showAlert(message, type) {\r\n      // Create and show custom alert\r\n      const alertDiv = document.createElement('div');\r\n      alertDiv.className = `custom-alert alert-${type}`;\r\n      alertDiv.innerHTML = `\r\n        <div class=\"alert-content\">\r\n          <span class=\"alert-icon\">\r\n            ${type === 'success' ? '✅' : type === 'warning' ? '⚠️' : '❌'}\r\n          </span>\r\n          <span class=\"alert-message\">${message}</span>\r\n        </div>\r\n      `;\r\n      \r\n      document.body.appendChild(alertDiv);\r\n      \r\n      // Animate in\r\n      setTimeout(() => alertDiv.classList.add('show'), 100);\r\n      \r\n      // Remove after 3 seconds\r\n      setTimeout(() => {\r\n        alertDiv.classList.remove('show');\r\n        setTimeout(() => document.body.removeChild(alertDiv), 300);\r\n      }, 3000);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}