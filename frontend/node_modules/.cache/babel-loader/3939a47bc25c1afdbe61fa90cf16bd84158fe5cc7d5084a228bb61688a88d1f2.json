{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container mt-4\"\n};\nconst _hoisted_2 = {\n  class: \"mb-3\"\n};\nconst _hoisted_3 = {\n  class: \"mb-3\"\n};\nconst _hoisted_4 = {\n  class: \"mb-3\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"mt-4\"\n};\nconst _hoisted_6 = {\n  class: \"table table-bordered table-striped\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[17] || (_cache[17] = _createElementVNode(\"h2\", null, \"Release Parking Spot\", -1 /* CACHED */)), _createCommentVNode(\" Form to confirm release \"), !$data.showDetails ? (_openBlock(), _createElementBlock(\"form\", {\n    key: 0,\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers((...args) => _ctx.submitRelease && _ctx.submitRelease(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_2, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    for: \"lot_id\",\n    class: \"form-label\"\n  }, \"Lot ID\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"lot_id\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.lot_id = $event),\n    class: \"form-control\",\n    readonly: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.lot_id]])]), _createElementVNode(\"div\", _hoisted_3, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    for: \"spot_id\",\n    class: \"form-label\"\n  }, \"Spot ID\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"spot_id\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.spot_id = $event),\n    class: \"form-control\",\n    readonly: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.spot_id]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    for: \"user_id\",\n    class: \"form-label\"\n  }, \"User ID\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"user_id\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.user_id = $event),\n    class: \"form-control\",\n    readonly: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.user_id]])]), _cache[9] || (_cache[9] = _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-success\"\n  }, \"Submit\", -1 /* CACHED */)), _createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-secondary ms-2\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.goToDashboard && $options.goToDashboard(...args))\n  }, \"Cancel\")], 32 /* NEED_HYDRATION */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Table format for release summary \"), $data.showDetails ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_cache[16] || (_cache[16] = _createElementVNode(\"h4\", {\n    class: \"mb-3\"\n  }, \"Release Summary\", -1 /* CACHED */)), _createElementVNode(\"table\", _hoisted_6, [_createElementVNode(\"tbody\", null, [_createElementVNode(\"tr\", null, [_cache[10] || (_cache[10] = _createElementVNode(\"th\", null, \"Lot ID\", -1 /* CACHED */)), _createElementVNode(\"td\", null, _toDisplayString($data.releaseResult.lot_id), 1 /* TEXT */)]), _createElementVNode(\"tr\", null, [_cache[11] || (_cache[11] = _createElementVNode(\"th\", null, \"Spot ID\", -1 /* CACHED */)), _createElementVNode(\"td\", null, _toDisplayString($data.releaseResult.spot_id), 1 /* TEXT */)]), _createElementVNode(\"tr\", null, [_cache[12] || (_cache[12] = _createElementVNode(\"th\", null, \"User ID\", -1 /* CACHED */)), _createElementVNode(\"td\", null, _toDisplayString($data.releaseResult.user_id), 1 /* TEXT */)]), _createElementVNode(\"tr\", null, [_cache[13] || (_cache[13] = _createElementVNode(\"th\", null, \"Parking Time\", -1 /* CACHED */)), _createElementVNode(\"td\", null, _toDisplayString($options.formatDateTime($data.releaseResult.parking_timestamp)), 1 /* TEXT */)]), _createElementVNode(\"tr\", null, [_cache[14] || (_cache[14] = _createElementVNode(\"th\", null, \"Release Time\", -1 /* CACHED */)), _createElementVNode(\"td\", null, _toDisplayString($options.formatDateTime($data.releaseResult.release_timestamp)), 1 /* TEXT */)]), _createElementVNode(\"tr\", null, [_cache[15] || (_cache[15] = _createElementVNode(\"th\", null, \"Total Cost\", -1 /* CACHED */)), _createElementVNode(\"td\", null, \"₹\" + _toDisplayString($data.releaseResult.total_cost), 1 /* TEXT */)])])]), _createElementVNode(\"button\", {\n    class: \"btn btn-primary mt-3\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.goToDashboard && $options.goToDashboard(...args))\n  }, \"Go to Dashboard\")])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","$data","showDetails","onSubmit","_cache","_withModifiers","args","_ctx","submitRelease","_hoisted_2","for","type","id","lot_id","$event","readonly","_hoisted_3","spot_id","_hoisted_4","user_id","onClick","$options","goToDashboard","_hoisted_5","_hoisted_6","_toDisplayString","releaseResult","formatDateTime","parking_timestamp","release_timestamp","total_cost"],"sources":["C:\\Users\\DELL\\OneDrive\\Desktop\\vehicle_parking_app_23f3004276\\frontend\\src\\views\\ReleaseSpot.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mt-4\">\r\n    <h2>Release Parking Spot</h2>\r\n\r\n    <!-- Form to confirm release -->\r\n    <form @submit.prevent=\"submitRelease\" v-if=\"!showDetails\">\r\n      <div class=\"mb-3\">\r\n        <label for=\"lot_id\" class=\"form-label\">Lot ID</label>\r\n        <input type=\"text\" id=\"lot_id\" v-model=\"lot_id\" class=\"form-control\" readonly />\r\n      </div>\r\n\r\n      <div class=\"mb-3\">\r\n        <label for=\"spot_id\" class=\"form-label\">Spot ID</label>\r\n        <input type=\"text\" id=\"spot_id\" v-model=\"spot_id\" class=\"form-control\" readonly />\r\n      </div>\r\n\r\n      <div class=\"mb-3\">\r\n        <label for=\"user_id\" class=\"form-label\">User ID</label>\r\n        <input type=\"text\" id=\"user_id\" v-model=\"user_id\" class=\"form-control\" readonly />\r\n      </div>\r\n\r\n      <button type=\"submit\" class=\"btn btn-success\">Submit</button>\r\n      <button type=\"button\" class=\"btn btn-secondary ms-2\" @click=\"goToDashboard\">Cancel</button>\r\n    </form>\r\n\r\n    <!-- Table format for release summary -->\r\n    <div v-if=\"showDetails\" class=\"mt-4\">\r\n      <h4 class=\"mb-3\">Release Summary</h4>\r\n      <table class=\"table table-bordered table-striped\">\r\n        <tbody>\r\n          <tr>\r\n            <th>Lot ID</th>\r\n            <td>{{ releaseResult.lot_id }}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Spot ID</th>\r\n            <td>{{ releaseResult.spot_id }}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>User ID</th>\r\n            <td>{{ releaseResult.user_id }}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Parking Time</th>\r\n            <td>{{ formatDateTime(releaseResult.parking_timestamp) }}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Release Time</th>\r\n            <td>{{ formatDateTime(releaseResult.release_timestamp) }}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Total Cost</th>\r\n            <td>₹{{ releaseResult.total_cost }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      <button class=\"btn btn-primary mt-3\" @click=\"goToDashboard\">Go to Dashboard</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nexport default {\r\n  name: 'ReleaseSpot',\r\n  data() {\r\n    return {\r\n      lot_id: this.$route.query.lot_id || '',\r\n      spot_id: this.$route.query.spot_id || '',\r\n      user_id: '',\r\n      releaseResult: null,\r\n      showDetails: false\r\n    };\r\n  },\r\n  created() {\r\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\r\n    this.user_id = user.user_id;\r\n  },\r\n  mounted() {\r\n    this.releaseSpot();  // Automatically call release on mount\r\n  },\r\n  methods: {\r\n    async releaseSpot() {\r\n      const token = localStorage.getItem('auth_token');\r\n\r\n      try {\r\n        const res = await fetch('http://localhost:5000/api/release-spot', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `${token}`\r\n          },\r\n          body: JSON.stringify({\r\n            lot_id: this.lot_id,\r\n            spot_id: this.spot_id,\r\n            user_id: this.user_id\r\n          })\r\n        });\r\n\r\n        const data = await res.json();\r\n\r\n        if (res.ok) {\r\n          this.releaseResult = data;\r\n          this.showDetails = true;\r\n        } else {\r\n          alert('❌ Release failed: ' + data.message);\r\n          this.$router.push('/user-dashboard');\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Fetch error:', error);\r\n        alert('⚠️ Server error while releasing spot.');\r\n        this.$router.push('/user-dashboard');\r\n      }\r\n    },\r\n    formatDateTime(timestamp) {\r\n      const date = new Date(timestamp);\r\n      return date.toLocaleString();\r\n    },\r\n    goToDashboard() {\r\n      this.$router.push({ path: '/user-dashboard', query: { refresh: 'true' } });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.container {\r\n  max-width: 600px;\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAgB;;EAKlBA,KAAK,EAAC;AAAM;;EAKZA,KAAK,EAAC;AAAM;;EAKZA,KAAK,EAAC;AAAM;;;EAUKA,KAAK,EAAC;;;EAErBA,KAAK,EAAC;AAAoC;;uBA3BrDC,mBAAA,CA0DM,OA1DNC,UA0DM,G,4BAzDJC,mBAAA,CAA6B,YAAzB,sBAAoB,qBAExBC,mBAAA,6BAAgC,E,CACaC,KAAA,CAAAC,WAAW,I,cAAxDL,mBAAA,CAkBO;;IAlBAM,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,KAAAC,IAAA,KAAUC,IAAA,CAAAC,aAAA,IAAAD,IAAA,CAAAC,aAAA,IAAAF,IAAA,CAAa;MAClCP,mBAAA,CAGM,OAHNU,UAGM,G,0BAFJV,mBAAA,CAAqD;IAA9CW,GAAG,EAAC,QAAQ;IAACd,KAAK,EAAC;KAAa,QAAM,qB,gBAC7CG,mBAAA,CAAgF;IAAzEY,IAAI,EAAC,MAAM;IAACC,EAAE,EAAC,QAAQ;+DAAUX,KAAA,CAAAY,MAAM,GAAAC,MAAA;IAAElB,KAAK,EAAC,cAAc;IAACmB,QAAQ,EAAR;iDAA7Bd,KAAA,CAAAY,MAAM,E,KAGhDd,mBAAA,CAGM,OAHNiB,UAGM,G,0BAFJjB,mBAAA,CAAuD;IAAhDW,GAAG,EAAC,SAAS;IAACd,KAAK,EAAC;KAAa,SAAO,qB,gBAC/CG,mBAAA,CAAkF;IAA3EY,IAAI,EAAC,MAAM;IAACC,EAAE,EAAC,SAAS;+DAAUX,KAAA,CAAAgB,OAAO,GAAAH,MAAA;IAAElB,KAAK,EAAC,cAAc;IAACmB,QAAQ,EAAR;iDAA9Bd,KAAA,CAAAgB,OAAO,E,KAGlDlB,mBAAA,CAGM,OAHNmB,UAGM,G,0BAFJnB,mBAAA,CAAuD;IAAhDW,GAAG,EAAC,SAAS;IAACd,KAAK,EAAC;KAAa,SAAO,qB,gBAC/CG,mBAAA,CAAkF;IAA3EY,IAAI,EAAC,MAAM;IAACC,EAAE,EAAC,SAAS;+DAAUX,KAAA,CAAAkB,OAAO,GAAAL,MAAA;IAAElB,KAAK,EAAC,cAAc;IAACmB,QAAQ,EAAR;iDAA9Bd,KAAA,CAAAkB,OAAO,E,+BAGlDpB,mBAAA,CAA6D;IAArDY,IAAI,EAAC,QAAQ;IAACf,KAAK,EAAC;KAAkB,QAAM,qBACpDG,mBAAA,CAA2F;IAAnFY,IAAI,EAAC,QAAQ;IAACf,KAAK,EAAC,wBAAwB;IAAEwB,OAAK,EAAAhB,MAAA,QAAAA,MAAA,UAAAE,IAAA,KAAEe,QAAA,CAAAC,aAAA,IAAAD,QAAA,CAAAC,aAAA,IAAAhB,IAAA,CAAa;KAAE,QAAM,E,iEAGpFN,mBAAA,sCAAyC,EAC9BC,KAAA,CAAAC,WAAW,I,cAAtBL,mBAAA,CAgCM,OAhCN0B,UAgCM,G,4BA/BJxB,mBAAA,CAAqC;IAAjCH,KAAK,EAAC;EAAM,GAAC,iBAAe,qBAChCG,mBAAA,CA2BQ,SA3BRyB,UA2BQ,GA1BNzB,mBAAA,CAyBQ,gBAxBNA,mBAAA,CAGK,a,4BAFHA,mBAAA,CAAe,YAAX,QAAM,qBACVA,mBAAA,CAAmC,YAAA0B,gBAAA,CAA5BxB,KAAA,CAAAyB,aAAa,CAACb,MAAM,iB,GAE7Bd,mBAAA,CAGK,a,4BAFHA,mBAAA,CAAgB,YAAZ,SAAO,qBACXA,mBAAA,CAAoC,YAAA0B,gBAAA,CAA7BxB,KAAA,CAAAyB,aAAa,CAACT,OAAO,iB,GAE9BlB,mBAAA,CAGK,a,4BAFHA,mBAAA,CAAgB,YAAZ,SAAO,qBACXA,mBAAA,CAAoC,YAAA0B,gBAAA,CAA7BxB,KAAA,CAAAyB,aAAa,CAACP,OAAO,iB,GAE9BpB,mBAAA,CAGK,a,4BAFHA,mBAAA,CAAqB,YAAjB,cAAY,qBAChBA,mBAAA,CAA8D,YAAA0B,gBAAA,CAAvDJ,QAAA,CAAAM,cAAc,CAAC1B,KAAA,CAAAyB,aAAa,CAACE,iBAAiB,kB,GAEvD7B,mBAAA,CAGK,a,4BAFHA,mBAAA,CAAqB,YAAjB,cAAY,qBAChBA,mBAAA,CAA8D,YAAA0B,gBAAA,CAAvDJ,QAAA,CAAAM,cAAc,CAAC1B,KAAA,CAAAyB,aAAa,CAACG,iBAAiB,kB,GAEvD9B,mBAAA,CAGK,a,4BAFHA,mBAAA,CAAmB,YAAf,YAAU,qBACdA,mBAAA,CAAwC,YAApC,GAAC,GAAA0B,gBAAA,CAAGxB,KAAA,CAAAyB,aAAa,CAACI,UAAU,iB,OAKtC/B,mBAAA,CAAoF;IAA5EH,KAAK,EAAC,sBAAsB;IAAEwB,OAAK,EAAAhB,MAAA,QAAAA,MAAA,UAAAE,IAAA,KAAEe,QAAA,CAAAC,aAAA,IAAAD,QAAA,CAAAC,aAAA,IAAAhB,IAAA,CAAa;KAAE,iBAAe,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}